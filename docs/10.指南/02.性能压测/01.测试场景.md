---
title: 测试场景
date: 2021-05-11 13:59:38
rightMenuBar: false
article: false
permalink: /pages/771df6/
---

## 创建异步任务

**创建AService**
```java
@Service
public class AService implements AsyncTask<DataContext, DataContext>, ParaExector {
    @Override
    public void callback(boolean success, DataContext param, TaskResult<DataContext> workResult) {
        if (success) {
            System.out.println("AService 成功");
        } else {
            System.out.println("AService 失败");
        }
    }
    @Override
    public DataContext task(DataContext params, GobrsAsyncSupport support) {
        try {
            Thread.sleep(1000);
            System.out.println("AService 执行完了");

        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        byte[] result  = new byte[1024*1024];
        Map h = new HashMap();
        h.put("result", result);
        params.setResult(h);
        return params;
    }
    @Override
    public boolean nessary(DataContext params, GobrsAsyncSupport support) {
        return true;
    }
}
```
**创建BService**
```java 
@Service
public class BService implements AsyncTask<DataContext, Map>, SerExector {

    @Override
    public void callback(boolean success, DataContext param, TaskResult<Map> workResult) {
        if (success) {
            System.out.println("BService 成功");
        } else {
            System.out.println("BService 失败");
        }
    }

    @Override
    public Map task(DataContext params, GobrsAsyncSupport support) {
        try {
            Thread.sleep(500);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        HashMap hashMap = new HashMap();
        hashMap.put("result", "我是B的结果");
        return null;
    }

    @Override
    public boolean nessary(DataContext params, GobrsAsyncSupport support) {
        return true;
    }
}
```
**创建EService**
```java  
@Service
public class EService implements AsyncTask<DataContext, DataContext>, ParaExector {

    @Override
    public void callback(boolean success, DataContext param, TaskResult<DataContext> workResult) {
        if (success) {
            System.out.println("EService 成功");
        } else {
            System.out.println("EService 失败");
        }
    }

    @Override
    public DataContext task(DataContext params, GobrsAsyncSupport support) {
        stopTaskFlow(support, 100);
        return params;
    }

    @Override
    public boolean nessary(DataContext params, GobrsAsyncSupport support) {
        return true;
    }
}

```

**创建FService**
```java  
@Service
public class FService implements AsyncTask<DataContext, Map>, SerExector {
    @Override
    public void callback(boolean success, DataContext param, TaskResult<Map> workResult) {
        if (success) {
            System.out.println("FService 成功");
        } else {
            System.out.println("FService 失败");
        }
    }

    @Override
    public Map task(DataContext params, GobrsAsyncSupport support) {
        try {
            DataContext result = getResult(support, EService.class, DataContext.class);
            System.out.println(JSONObject.toJSONString(result.getResult()));
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    public boolean nessary(DataContext params, GobrsAsyncSupport support) {
        return true;
    }
}
```
