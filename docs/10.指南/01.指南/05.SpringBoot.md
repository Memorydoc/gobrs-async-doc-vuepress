---
title: SpringBoot 
date: 2020-05-11 13:54:56 
permalink: /pages/2f674a 
article: false

---

## 准备条件

所需运行环境

* **Maven**
* **JDK1.8**
* **Spring**

:::tip 提示
本框架为复杂上游调用了逻辑而设计， 如果只是单纯的使用多线程开发任务， 如果<code>Future</code> 或线程池就可满足用户需求，无需使用本框架。 如果不清楚本框架的使用场景，
请阅读 [简介](/pages/52d5c3 )
:::

## Gobrs-Async 配置

### Maven依赖

```xml

<dependency>
    <groupId>io.github.memorydoc</groupId>
    <artifactId>gobrs-async-starter</artifactId>
    <version>1.0.9-RELEASE</version>
</dependency>
```

### 配置 application.yml

```yaml
server:
  port: 8888
spring:
  gobrs:
    async:
      rules: '[{name: "test", content: "AService->BService,CService,GService,DService, FService:not;EService->FService"}]'
      #      rules: '[{name: "test", content: "BService->CService->EService->DService:not;AService->DService:not"}]'
      task-interrupt: true #局部异常是否打断主流程
```

## 使用任务触发器

```java 
@Resource
private GobrsTaskFlow taskFlow;
```

## 启动任务流程

```java 
// 一行代码即可启动任务流程
// 任务流名称 , 任务流参数, 任务超时时间
Map<String, Object> params  = new HashMap();
AsyncResult asyncResult = taskFlow.taskFlow("test", params, 100000);
```


任务流程的params参数 有两种参数形式。
### 参数类型一
如果任务流程中所有任务 都是用同一个参数进行传递传递， 则params 直接传入公用的同一个参数即可
```java 
User user = new User();
AsyncResult asyncResult = taskFlow.taskFlow("test", user, 100000);
```


### 参数类型二
如果任务流程中不同任务使用不同的参数。则参数需要传递Map类型， Map的key 为 任务bean 名称， 值为所需要传递的参数值。

```java 
User user = new User();
Fruit fruit = new Fruit();

Map<String,Object> params = new HashMap();
params.put("A", user);
params.put("B", fruit);

AsyncResult asyncResult = taskFlow.taskFlow("test", params, 100000);
```





